
<section class="page" role="main">
  <header class="flex flex-center flex-justify mb3 px3 max-px0">
    <div class="flex mr3">
      <h1 class="h1">Products</h1>
      <span class="callout">{{products.products.length}}</span>
    </div>
    <div class="flex" role="toolbar">
      <button ng-click="clearActiveProduct();showProductForm()" class="button color-action">Add product</button>
    </div>
  </header>

  <!-- ng-show="showManageProduct=='true'"  -->
  <manage-product 
    ng-show='productFormIsvisible'
    product=activeProduct >  
  </manage-product>
  
  <!-- todo: this becomes a directive -->
  <div class="controls flex flex-center mb3">
    <label class="form__label mr2 mb0" for="stock-quantity">Show products with stock levels less than:</label>
    <div>
      <input 
        ng-model="stockLevelSearch"
        aria-controls="products" 
        class="form__input form__input--number" 
        id="stock-quantity" 
        placeholder="enter quantity" 
        type="number" />
    </div>
  </div>
  <table class="table" id="products">
    <tbody>
      <tr class="table__row-header">
        <th class="table__cell-header">Name</th>
        <th class="table__cell-header">Supplier</th>
        <th class="table__cell-header">Stock Level</th>
        <th class="table__cell-header">Price (ex. tax)</th>
        <th class="table__cell-header">Price (inc. tax)</th>
      </tr>
      <!-- Clicking a row should take us to the product detail page -->

      <tr 
        ng-repeat="product in products.products" 
        ng-if="stockLevelSearch==0 || product.stock_level < stockLevelSearch"        
        class="table__row">
        <td 
          ng-click="setActiveProduct(product);"
          class="table__cell" data-label="Name" >
          <span class="color-gray mr1" title="Item number">{{product.id}}</span>{{product.name}}</td>
        <td class="table__cell" data-label="Supplier">{{product.product_supplier_name}}</td>
        <td class="table__cell" data-label="Stock Level">{{product.stock_level}}</td>
        <td class="table__cell" data-label="Price (ex. tax)">${{product.price_ex_tax}}</td>
        <td class="table__cell" data-label="Price (inc. tax)">${{product.price_ex_tax}}</td>
      </tr>
      
    </tbody>
  </table>
</section>